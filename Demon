--[[
  Reusable Roblox UI Library API
  Usage:
    local Library = loadstring(...)()
    local Window = Library:CreateWindow("Title")
    local Tab = Window:CreateTab("Tab 1")
    Tab:AddButton("Button", function() end)
    Tab:AddToggle("Toggle", false, function(v) end)
    Tab:AddSlider("Slider", 0, 10, 5, function(v) end)
    Tab:AddLabel("Label")
    Tab:AddParagraph("Paragraph", "Paragraph Content")
]]

local Library = {}
local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local UIS = game:GetService("UserInputService")

local Player = Players.LocalPlayer

-- Helpers
local function corner(obj, r)
    local c = Instance.new("UICorner")
    c.CornerRadius = UDim.new(0, r or 8)
    c.Parent = obj
end

-- Window
function Library:CreateWindow(title)
    local ScreenGui = Instance.new("ScreenGui")
    ScreenGui.Name = "UILibrary"
    ScreenGui.ResetOnSpawn = false
    ScreenGui.Parent = Player:WaitForChild("PlayerGui")

    local Main = Instance.new("Frame", ScreenGui)
    Main.Size = UDim2.fromScale(0.35, 0.45)
    Main.Position = UDim2.fromScale(0.5, 0.5)
    Main.AnchorPoint = Vector2.new(0.5, 0.5)
    Main.BackgroundColor3 = Color3.fromRGB(25,25,25)
    Main.BorderSizePixel = 0
    corner(Main, 10)

    local TitleBar = Instance.new("Frame", Main)
    TitleBar.Size = UDim2.new(1,0,0,40)
    TitleBar.BackgroundColor3 = Color3.fromRGB(18,18,18)
    TitleBar.BorderSizePixel = 0
    corner(TitleBar, 10)

    local Title = Instance.new("TextLabel", TitleBar)
    Title.Text = title or "UI Library"
    Title.Font = Enum.Font.GothamBold
    Title.TextSize = 14
    Title.TextColor3 = Color3.fromRGB(235,235,235)
    Title.BackgroundTransparency = 1
    Title.Size = UDim2.new(1,-40,1,0)
    Title.Position = UDim2.new(0,12,0,0)
    Title.TextXAlignment = Left

    local Close = Instance.new("TextButton", TitleBar)
    Close.Text = "Ã—"
    Close.Font = Enum.Font.GothamBold
    Close.TextSize = 18
    Close.TextColor3 = Color3.fromRGB(200,200,200)
    Close.BackgroundTransparency = 1
    Close.Size = UDim2.new(0,40,1,0)
    Close.Position = UDim2.new(1,-40,0,0)
    Close.MouseButton1Click:Connect(function()
        ScreenGui:Destroy()
    end)

    local Tabs = Instance.new("Frame", Main)
    Tabs.Size = UDim2.new(0,90,1,-40)
    Tabs.Position = UDim2.new(0,0,0,40)
    Tabs.BackgroundColor3 = Color3.fromRGB(20,20,20)
    Tabs.BorderSizePixel = 0
    corner(Tabs, 10)

    local TabsLayout = Instance.new("UIListLayout", Tabs)
    TabsLayout.Padding = UDim.new(0,6)
    TabsLayout.HorizontalAlignment = Center

    local Pages = Instance.new("Frame", Main)
    Pages.Size = UDim2.new(1,-90,1,-40)
    Pages.Position = UDim2.new(0,90,0,40)
    Pages.BackgroundTransparency = 1

    local Window = {}
    local currentPage

    function Window:CreateTab(name)
        local TabButton = Instance.new("TextButton", Tabs)
        TabButton.Text = name
        TabButton.Font = Enum.Font.Gotham
        TabButton.TextSize = 12
        TabButton.TextColor3 = Color3.fromRGB(220,220,220)
        TabButton.BackgroundColor3 = Color3.fromRGB(30,30,30)
        TabButton.Size = UDim2.new(1,-10,0,28)
        corner(TabButton)

        local Page = Instance.new("Frame", Pages)
        Page.Size = UDim2.new(1,0,1,0)
        Page.Visible = false
        Page.BackgroundTransparency = 1

        local Layout = Instance.new("UIListLayout", Page)
        Layout.Padding = UDim.new(0,10)

        TabButton.MouseButton1Click:Connect(function()
            if currentPage then currentPage.Visible = false end
            currentPage = Page
            Page.Visible = true
        end)

        if not currentPage then
            currentPage = Page
            Page.Visible = true
        end

        local Tab = {}

        function Tab:AddButton(text, callback)
            local B = Instance.new("TextButton", Page)
            B.Text = text
            B.Font = Enum.Font.Gotham
            B.TextSize = 13
            B.TextColor3 = Color3.fromRGB(235,235,235)
            B.BackgroundColor3 = Color3.fromRGB(35,35,35)
            B.Size = UDim2.new(1,-20,0,32)
            corner(B)
            B.MouseButton1Click:Connect(function()
                if callback then callback() end
            end)
        end

        function Tab:AddToggle(text, default, callback)
            local state = default
            local T = Instance.new("TextButton", Page)
            T.Text = text
            T.Font = Enum.Font.Gotham
            T.TextSize = 13
            T.TextColor3 = Color3.fromRGB(235,235,235)
            T.BackgroundColor3 = state and Color3.fromRGB(60,120,255) or Color3.fromRGB(35,35,35)
            T.Size = UDim2.new(1,-20,0,32)
            corner(T)
            T.MouseButton1Click:Connect(function()
                state = not state
                T.BackgroundColor3 = state and Color3.fromRGB(60,120,255) or Color3.fromRGB(35,35,35)
                if callback then callback(state) end
            end)
        end

        function Tab:AddSlider(text, min, max, default, callback)
            local val = default or min
            local Frame = Instance.new("Frame", Page)
            Frame.Size = UDim2.new(1,-20,0,40)
            Frame.BackgroundColor3 = Color3.fromRGB(35,35,35)
            corner(Frame)

            local Label = Instance.new("TextLabel", Frame)
            Label.Text = text..": "..val
            Label.Font = Enum.Font.Gotham
            Label.TextSize = 12
            Label.TextColor3 = Color3.fromRGB(200,200,200)
            Label.BackgroundTransparency = 1
            Label.Size = UDim2.new(1,-20,0,20)
            Label.Position = UDim2.new(0,10,0,0)
            Label.TextXAlignment = Left

            local Bar = Instance.new("Frame", Frame)
            Bar.Size = UDim2.new(1,-20,0,6)
            Bar.Position = UDim2.new(0,10,0,26)
            Bar.BackgroundColor3 = Color3.fromRGB(20,20,20)
            corner(Bar)

            local Fill = Instance.new("Frame", Bar)
            Fill.BackgroundColor3 = Color3.fromRGB(60,120,255)
            Fill.Size = UDim2.new((val-min)/(max-min),0,1,0)
            corner(Fill)

            local dragging = false
            Bar.InputBegan:Connect(function(i)
                if i.UserInputType == Enum.UserInputType.MouseButton1 then dragging = true end
            end)
            Bar.InputEnded:Connect(function(i)
                if i.UserInputType == Enum.UserInputType.MouseButton1 then dragging = false end
            end)
            UIS.InputChanged:Connect(function(i)
                if dragging and i.UserInputType == Enum.UserInputType.MouseMovement then
                    local pct = math.clamp((i.Position.X-Bar.AbsolutePosition.X)/Bar.AbsoluteSize.X,0,1)
                    val = math.floor((min + (max-min)*pct))
                    Fill.Size = UDim2.new(pct,0,1,0)
                    Label.Text = text..": "..val
                    if callback then callback(val) end
                end
            end)
        end

        function Tab:AddLabel(text)
            local L = Instance.new("TextLabel", Page)
            L.Text = text
            L.Font = Enum.Font.GothamBold
            L.TextSize = 13
            L.TextColor3 = Color3.fromRGB(235,235,235)
            L.BackgroundTransparency = 1
            L.Size = UDim2.new(1,-20,0,20)
            L.TextXAlignment = Left
        end

        function Tab:AddParagraph(title, text)
            local T = Instance.new("TextLabel", Page)
            T.Text = title.."\n"..text
            T.Font = Enum.Font.Gotham
            T.TextSize = 12
            T.TextWrapped = true
            T.TextColor3 = Color3.fromRGB(180,180,180)
            T.BackgroundTransparency = 1
            T.Size = UDim2.new(1,-20,0,40)
            T.TextXAlignment = Left
        end

        return Tab
    end

    return Window
end

return Library
